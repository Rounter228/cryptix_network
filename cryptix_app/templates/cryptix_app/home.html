{% extends 'cryptix_app/base.html' %}

{% block title %}–ì–æ–ª–æ–≤–Ω–∞ - Cryptix{% endblock %}

{% block content %}
<div class="card">
    <h2>üè† –ì–æ–ª–æ–≤–Ω–∞ —Å—Ç–æ—Ä—ñ–Ω–∫–∞ Cryptix</h2>
    <p>–õ–∞—Å–∫–∞–≤–æ –ø—Ä–æ—Å–∏–º–æ! –¢—É—Ç –≤–∏ –∑–Ω–∞–π–¥–µ—Ç–µ –Ω–æ–≤–∏–Ω–∏ —Ç–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –≤—ñ–¥ –∫–æ–º–∞–Ω–¥–∏ Cryptix.</p>
</div>

{% if is_admin %}
<div class="card" style="border-left: 4px solid #3b82f6;">
    <h3>‚úçÔ∏è –°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤–∏–Ω—É (—Ç—ñ–ª—å–∫–∏ –¥–ª—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤)</h3>
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        
        <label style="color: #cbd5e1;">–ó–∞–≥–æ–ª–æ–≤–æ–∫:</label>
        <input type="text" name="title" placeholder="–ó–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–æ–≤–∏–Ω–∏..." required>
        
        <label style="color: #cbd5e1;">–¢–µ–∫—Å—Ç –Ω–æ–≤–∏–Ω–∏:</label>
        <textarea name="content" placeholder="–¢–µ–∫—Å—Ç –Ω–æ–≤–∏–Ω–∏..." rows="5" required></textarea>
        
        <label for="news_image" style="cursor: pointer; color: #3b82f6; display: block; margin: 10px 0;">üì∑ –î–æ–¥–∞—Ç–∏ –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è</label>
        <input type="file" name="image" id="news_image" accept="image/*" style="display: none;">
        
        <label style="display: flex; align-items: center; margin: 15px 0; color: #cbd5e1;">
            <input type="checkbox" name="is_pinned" style="width: auto; margin-right: 10px;">
            üìå –ó–∞–∫—Ä—ñ–ø–∏—Ç–∏ –Ω–æ–≤–∏–Ω—É
        </label>
        
        <button type="submit">–û–ø—É–±–ª—ñ–∫—É–≤–∞—Ç–∏ –Ω–æ–≤–∏–Ω—É</button>
    </form>
</div>
{% endif %}

{% for news in news_list %}
<div class="card {% if news.is_pinned %}pinned-news{% endif %}">
    {% if news.is_pinned %}
    <div style="background: rgba(245, 158, 11, 0.2); color: #fbbf24; padding: 5px 10px; border-radius: 4px; display: inline-block; margin-bottom: 10px; font-size: 12px; font-weight: bold;">
        üìå –ó–ê–ö–†–Ü–ü–õ–ï–ù–û
    </div>
    {% endif %}
    
    <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 15px;">
        <div>
            <h3 style="margin: 0 0 5px 0; color: #3b82f6;">{{ news.title }}</h3>
            <small style="color: #94a3b8;">
                –ê–≤—Ç–æ—Ä: <strong style="color: #cbd5e1;">{{ news.author.username }}</strong> ‚Ä¢ 
                {{ news.created_at|date:"d.m.Y H:i" }}
                {% if news.updated_at != news.created_at %}
                    (–æ–Ω–æ–≤–ª–µ–Ω–æ {{ news.updated_at|date:"d.m.Y H:i" }})
                {% endif %}
            </small>
        </div>
        
        {% if is_admin %}
        <div style="display: flex; gap: 5px;">
            <a href="{% url 'news_edit' news.id %}">
                <button class="btn-secondary" style="padding: 5px 10px; font-size: 12px;">–†–µ–¥–∞–≥—É–≤–∞—Ç–∏</button>
            </a>
            <form method="post" action="{% url 'news_delete' news.id %}" style="margin: 0;" onsubmit="return confirm('–í–∏–¥–∞–ª–∏—Ç–∏ –Ω–æ–≤–∏–Ω—É?');">
                {% csrf_token %}
                <button type="submit" class="btn-danger" style="padding: 5px 10px; font-size: 12px;">–í–∏–¥–∞–ª–∏—Ç–∏</button>
            </form>
        </div>
        {% endif %}
    </div>
    
    {% if news.image %}
    <img src="{{ news.image.url }}" alt="{{ news.title }}" style="max-width: 100%; border-radius: 8px; margin-bottom: 15px;">
    {% endif %}
    
    <p style="white-space: pre-wrap; line-height: 1.6; color: #cbd5e1;">{{ news.content }}</p>
</div>
{% empty %}
<div class="card">
    <p style="text-align: center; color: #94a3b8;">
        –ü–æ–∫–∏ —â–æ –Ω–µ–º–∞—î –Ω–æ–≤–∏–Ω. –°–ª—ñ–¥–∫—É–π—Ç–µ –∑–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è–º–∏! üöÄ
    </p>
</div>
{% endfor %}

<style>
    .pinned-news {
        border-left: 4px solid #f59e0b;
        background: rgba(245, 158, 11, 0.1);
    }
</style>
{% endblock %}